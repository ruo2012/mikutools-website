(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{2466:function(e,n,t){"use strict";t.r(n);t(31),t(56);var r,o=t(13),c=t(784);r=t(852).fabric;var l={name:"Ruyao",data:function(){return{n:null,logo:null,backgroundImage:null,canvas:null}},head:function(){return this.$store.state.currentTool.head},mounted:function(){this.canvas=new r.Canvas(this.$refs.canvas)},methods:{handleChange:function(e){var n=this,t=e.target.files;if(!t.length)return!1;var r=t[0],c=new FileReader;c.readAsDataURL(r),c.addEventListener("load",Object(o.a)(regeneratorRuntime.mark((function e(){var image;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(image=new Image).onload=function(){n.backgroundImage=image,n.$nextTick(n.renderCanvas)},image.src=c.result;case 3:case"end":return e.stop()}}),e)}))),!1)},renderCanvas:function(){var e=this;this.canvas.clear();var image=this.backgroundImage,n=this.$refs.box.offsetWidth,t=1;image.width>n?(this.canvas.setWidth(n),this.canvas.setHeight(n/image.width*image.height),t=n/image.width):(this.canvas.setWidth(image.width),this.canvas.setHeight(image.height)),this.getLogo().then((function(){var t=image.width/2/e.logo.width;image.width>n&&(t=n/2/e.logo.width);var o=new r.Image(e.logo,{scaleX:t,scaleY:t,left:0,top:0});e.canvas.add(o),o.centerH(),e.canvas.renderAll()}));var o=new r.Image(image,{scaleX:t,scaleY:t,left:0,top:0,selectable:!1});this.canvas.setBackgroundImage(o)},getLogo:function(){var e=this;return new Promise((function(n,t){var image=new Image;image.onload=function(){e.logo=image,n(image)},image.onerror=t,image.src="/images/ruyao.png"}))},save:function(){if(!this.n)return!1;this.canvas.lowerCanvasEl.toBlob((function(e){Object(c.a)(URL.createObjectURL(e),"ruyao.png")}))}}},h=t(5),component=Object(h.a)(l,(function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"ruyao"},[t("nya-container",{attrs:{title:"乳摇图片制作"}},[t("div",{staticClass:"nya-subtitle"},[e._v("\n            请选择要制作的图片\n        ")]),e._v(" "),t("el-input",{attrs:{type:"file",accept:"image/*",placeholder:e.n?e.n.replace(/C:\\fakepath\\/,""):"点击这里上传文件"},nativeOn:{change:function(n){return e.handleChange(n)}},model:{value:e.n,callback:function(n){e.n=n},expression:"n"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.save},slot:"append"},[e._v("\n                保存\n            ")])],1)],1),e._v(" "),t("nya-container",{directives:[{name:"show",rawName:"v-show",value:e.n,expression:"n"}],attrs:{title:"预览"}},[t("div",{ref:"box",staticClass:"box"},[t("canvas",{ref:"canvas"})])]),e._v(" "),t("nya-container",{attrs:{title:"使用方法"}},[t("ul",{staticClass:"nya-list"},[t("li",[e._v("点击上传图片，选择完图片后在【预览区】拖动图片进行图片大小和位置的调整，之后点击【保存】即可下载图片到本地")]),e._v(" "),t("li",[t("a",{attrs:{href:"/images/ruyao_demo.jpg",target:"_blank",rel:"noopener noreferrer"}},[e._v("点击这里")]),e._v(" 打开图片后晃动手机，即可看到中间一块区域会晃动")])])])],1)}),[],!1,null,null,null);n.default=component.exports},784:function(e,n,t){"use strict";n.a=function(e,n){var a=document.createElement("a");a.href=e,a.download=n,a.click()}},853:function(e,n){},854:function(e,n){},855:function(e,n){}}]);